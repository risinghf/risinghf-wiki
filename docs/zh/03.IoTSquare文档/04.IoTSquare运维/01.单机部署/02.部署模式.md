---
permalink: /03/04/01/02/
title: 部署模式
date: 2023-02-28 17:00:00
---

## 1. 单机部署模式

IoTSquare默认给客户部署的方式是通过Docker和docker-compose在单一一台服务器(或虚拟机)上安装，
其中。
这种部署模式优点是部署简单、快速，但因为所有的服务进程（包括数据库PostgreSQL）都跑在一台服务器上，相互竞争CPU/IO等资源，没有多机器冗余，
所以无法保证服务跨机器的高可用，也没有提供数据备份（在原机器进行数据备份意义也不大）。

如果客户业务场景要求更高的可用性、容灾，则需要客户跟据IoTSquare架构，结合自己的应用服务架构，做出思考，对部署进行一些调整，可行的建议包括：
* 可以对服务器整体的镜像备份，提供在另一台服务器上的恢复方式，以提供容灾
* 也可以用如下计算与存储分离的部署模式，将IoTSquare中的数据库接管纳自到自己的运维体系，由专门的DBA/运维工程师进行统一的管理、监控、定期备份。
* 通过DNS的公网或内网域名的方式访问服务器的Web/API/MQTT协议，以确保后续迁移服务器的可行性

## 2. 计算与存储分离部署模式

IoTSquare用到的存储有Minio/Redis/PostgreSQL，
这种部署模式下最基础要求将数据库PostgreSQL部署到独立机器上，由专门的DBA/运维工程师进行统一的管理、监控、定期备份，
以确保数据库的性能、保证可用性、运行稳定性。如果IoTSquare部署在阿里云ECS/AWS EC2上，那么云数据库RDS则是最佳选择。

另外程序中用到少量的文件存储功能，使用的是S3兼容的对象存储，默认部署Minio即足够。如果IoTSquare部署在
阿里云ECS/AWS EC2上，那么对象存储也可以迁移到云上的OSS/S3对象存储，从而实现数据存储的彻底分离，
依赖云对象存储承诺可靠性保证数据可靠性。

这种部署在云上更易实现。

## 3. 容器集群部署模式

待补充