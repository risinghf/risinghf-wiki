---
title: Relay 组件使用手册
date: 2021-04-21 16:28:19
permalink: /02.manual/10.iotsquare/04.Relay/
---
# Relay 组件使用手册

::: warning

中继服务组件为 `Iotsquare` 服务器的子组件，具有缓存模式 和重放模式，中继 的引入主要解决边缘设备连接问题。对于边缘设备，在信号条件不稳定情况下，难以进行可靠的通信， 由于边缘设备数量较少，考虑到成本因素，不适合再去布置新的网关。因此，通过添加一个中继主机，进行节点与网关间数据的转发。

:::

## 1.中继设置

参考 `[UM120095]` LoRaWAN 中继用户使用手册

## 2.网关设置

这⾥对于⽹关的配置不详细叙述, 如果使⽤的是瑞兴恒⽅⽹络(深圳)有限公司的⽹关, 请查看对应⽹关型号的配置⽂档;

::: warning

中继新增唤醒功能，需确认 `pktfwd` 协议是否支持

:::

## 3.中继服务组件

### 3.1 创建应用

⽤⼾创建中继应⽤,需要在扩展协议下拉框选择选择 `relay` 协议, 推送接口可以填写 `http` 或 `https` 两种方式, 用户也可在 `Header` 字段中填写 `Token` 信息, 增加用户推送接口的安全性;

::: warning

创建应用时, 请不要使能 `MQTT` 权限

:::

![创建应用](创建应用.png)

### 3.2 创建设备

⽤⼾创建设备, 按要求填写 `DevEUI` `AppEUI` `AppKey` 频率区域以及设备类型, 来注册设备

![创建设备](创建设备.png)

### 3.3 功能列表

点击创建好的设备, 跳转到设备详情⻚, 点击中继组件下拉框, 可以看到如下中继组件功能模块, 主要有中继设备的状态管理, 配置管理,从机管理,下⾏窗口,历史状态等.

![功能列表](功能列表.png)

### 3.4 中继从机管理

中继从机管理是对中继的从机设备管理，含有从机状态列表，从机设备绑定，从机设备解绑等.

### 3.4.1 获取从机列表

点击更新从机列表后, 会使用主动唤醒方式下行数据,中继设备上报最新从机列表和中继设备状态，等待上报结果，正常约等于 `5s`

![ 获取从机列表](从机列表.png)

### 3.4.2 绑定从机设备

点击绑定从机列表后，弹出未绑定的从机设备，可选择设备进行绑定，一次只能选择一个设备进行绑定，等待上报结果，正常约等于 `5s`

![ 绑定从机设备](绑定从机设备.png)

### 3.4.3 解绑从机设备

点击解绑设备后，弹出确认解绑按钮，点击确认解绑，触发设备解绑，一次只能选择一个设备进行解绑定，等待上报结果，正常约等于 `5s`

 ![解绑从机设备](解绑从机设备.png)

### 3.5 中继配置管理

中继配置管理是对中继的配置参数管理，含有获取中继最新配置，修改中继配置参数，中继配置参数状态等.

 ![中继配置管理](中继配置.png)

### 3.5.1 获取中继最新配置

点击获取中继最新配置，弹出对话框确定，会主动下行，中继设备上报配置参数等信息. 等待上报结果，正常约等于 `5s`

 ![获取中继配置](获取中继配置.png)

### 3.5.2 修改中继配置

点击修改中继配置，修改中继配置参数，主动下行，等待修改结果，正常约等于 `5s`

 ![ 修改中继配置](修改中继配置.png)

### 3.6 数据下行

数据下行窗口包含有中继下行窗口，使用唤醒模式下行或非唤醒模式下行；下行记录，其中下发状态栏, 表⽰节点是否有收到此下⾏数据

 ![数据下行](下行历史.png)

### 3.6.1 下行窗口

点击中继下行窗口，即可跳转到下⾏窗口⻚⾯,  填⼊下⾏数据帧端口号, `hex` ⽅式下⾏数据, 默认选择⾮确认帧，非唤醒模式下发, 即可下发下⾏数据 ，选择唤醒模式下发，当设备睡眠模式时会被唤醒接收数据

 ![下行窗口](下行窗口.png)

### 3.6.2 下行记录

点击最近消息，默认显示当天数据；选择时间筛选，最大范围一周

### 3.7 中继历史消息

中继历史消息含有中继状态记录，中继事件记录（绑定，解绑，修改中继配置记录），默认显示近 `10` 条记录

 ![中继历史消息](中继记录.png)
