---
title: Uer Manual
date: 2021-09-14 15:44:17
permalink: /01/01/06/04/
---
## AT Command Specification

### 1 Introduction

RisingHF™ LoRaWAN™ modem is LoRaWAN compatible device, which supports flexible LoRaWAN communication. This document is intended to describe a command interface implementation of LoRaWAN Class A/B/C protocol. LoRaWAN protocol is available from LoRa Alliance, it is recommended to review LoRaWAN specification before using LoRaWAN modem.

#### 1.1 Feature


- LoRaWAN R1.0.2B band plan:
  - EU868 US915 US915HYBRID CN779 EU433 AU915 AU915OLD CN470 AS923 KR920 IN865
- User defined band plan:
  - CN470PREQUEL STE920
- LoRaWAN Class A/B/C
- All LoRaWAN 1.0.2B Class A/B/C MAC command:
  - LinkCheckReq / LinkCheckAns
  - LinkADRReq / LinkADRAns
  - DutyCycleReq / DutyCycleAns
  - RXParamSetupReq / RXParamSetupAns
  - DevStatusReq / DevStatusAns
  - NewChannelReq / NewChannelAns
  - RXTimingSetupReq / RXTimingSetupAns
  - TxParamSetupReq / TxParamSetupAns
  - DlChannelReq / DlChannelAns
  - DeviceTimeReq / DeviceTimeAns
  - PingSlotInfoReq / PingSlotInfoAns
  - PingSlotChannelReq / PingSlotChannelAns
  - BeaconTimingReq / BeaconTimingAns
  - BeaconFreqReq / BeaconFreqAns
- LoRaWAN dynamic select Port Zero / FOpts to send uplink MAC command
- Flexible RXWIN2 configuration interface
- Configurable RXWIN1 channel frequency
- Possibility to enable full-duplex LoRaWAN system
- Maximum configurable 96 channels
- Maximum 255 bytes RF frame
- User configuration nonvolatile
- Numerous test commands (LoRa P2P, Class C downlink, Continuous Wave etc.)
- Flexible hexadecimal string parser
- Ultra-low power (1.4uA@3.3V 1.9uA@3.3 watchdog on)1, intelligent auto low power mode
- Case insensitive commands
- 256 bytes EEPROM to save user data
- RTC time and supply voltage measurement

- Power supply measurement
- AT+LOG to speed up development debugging
- Intelligent LoRaWAN beacon time auto correction
- Multicast for Class B and Class C mode
- Configurable leap seconds through AT command

#### 1.2 Related Products

| Part Number               | Bootloader | Interface |
| ------------------------- | ---------- | --------- |
| RHF76-052DM               | UART       | UART      |
| RHF76-052CL               | UART       | UART      |
| RHF3M076B                 | USB        | USB       |
| RHF3M076B                 | USB        | USB       |
| RHF0M003-LF20             | UART       | UART      |
| RHF0M003-HF20             | UART       | UART      |
| RHF0M010-LF20             | UART       | UART      |
| RHF0M010-HF20 |UART |UART  |
|RHF0M062-LF22 |UART |UART|
|RHF0M062-HF22| UART| UART|


## 2 Preface

### 2.1 Conventions

- Command is case insensitive;
- All commands have response;
- Command length never exceeds total 528 characters;
- One valid AT Command must end with '\n', "\r\n" is also valid;
- If command timeout feature is enabled, end '\n' will not be mandatory;
- \<LF> means the newline character. \<CR> means carriage return;
- Default UART2 configuration "9600, 8, n,1" (8 bits data, no parity, 1 stop bit);

### 2.2 Symbols
- = --> Set value for command

- ? --> Query

- : --> Start a list input parameter

- + --> Prefix of command

- , --> Separator of parameters

- Space --> Empty character, could be used to format command

NOTE: You could use quote sign < " > to force input parameter with space, such as <AT+MSGHEX="AA BB CC DD EE">, then "AA BB CC
  DD EE" is treated as one parameter. But if you input command <AT+MSGHEX=AA BB CC DD EE>, "AA BB CC DD EE" will treated as 5
  parameters, AT+MSGHEX returns error.

### 2.3 Format

All commands in this document are end with . In order to facilitate the description, all is intentionally omitted in this document.

#### 2.3.1 Query

Use query command to check LoRaWAN modem configuration, such as channel configuration, ADR status, TX power, etc. AT+COMMAND AT+COMMAND? AT+COMMAND=? NOTE: Query format is available with every LoRaWAN supported command

#### 2.3.2 Configure / Control

Uses configure/control command to set new configuration or control transaction. AT+COMMAND=DATA

#### 2.3.3 Return 

Return data is in format like "+CMD: RETURN DATA" +COMMAND: "RETURN DATA"



[^]: **RHF76-052AM supports UART interface**
[^]: **RHF3M076B** supports USB CDC interface of which UART configuration is unconcerned

### 2.4 Error

|Code| Comment|
| ------------------------- | ---------- | 
|-1 |Parameters is invalid|
|-10 |Command unknown|
|-11| Command is in wrong format|
|-12| Command is unavailable in current mode (Check with "AT+MODE")|
|-20| Too many parameters. LoRaWAN modem support max 15 parameters|
|-21 |Length of command is too long (exceed 528 bytes)|
|-22| Receive end symbol timeout, command must end with \<LF>|
|-23| Invalid character received|
|-24| Either -21, -22 or -23|

This error code list applies to all LoRaWAN supported command. User could refer to this list to know what is happening to LoRaWAN modem, when gets errors.

### 2.5 EEPROM

Items below will be synchronized to EEPROM of LoRaWAN modem once changed successfully, this makes LoRaWAN modem memorized, user doesn't need to reconfigure parameter after repower, LoRaWAN modem helps to keep it. If user wants to go back factory default configuration, refer to 4.21 FDEFAULT.

|Item|
|--------|
|Channel frequency, datarate range|
|(up to 96 channels)|
|Datarate|
|TX power|
|ADR|
|RX Window2 frequency/datarate|
|RX Window1 frequency|
|Keys(NwkSkey, AppSkey, AppKey)|
|ID(DevAddr, DevEui, AppEui)|
|Port|
|Unconfirmed message repetition|
|Confirmed message retry|
|Mode3|
|LWABP/LWOTAA|
|Delay(RX1, RX2, JRX1, JRX2)|
|Multicast parameters|
|(MC_DevAddr, MC_ NwkSkey, MC_ AppSkey)|

[^]: Test mode is not stored; a reset during test mode makes modem switch back to previous mode.



## 3 Band Plans

RisingHF LoRaWAN Class A/B/C AT modem devices support: LoRaWAN 1.0.2B Band Plans:

 EU868 US915 US915HYBRID CN779 EU433 AU915 AU915OLD CN470 AS923 KR920 IN865 

Customized band plans:

 CN470PREQUEL STE920 

Refer to LoRaWANRegionalParametersv1.0.2_final_1944_1.pdf for details. 

### 3.1 Data Rate Scheme

![image-20210903142309426](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/da5a521fa3a44b3b4f7711396d8442a2.png)

![image-20210903142345219](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/7fc89c5a6d04b231493bbbd532331299.png)

### 3.2 Payload Length Limitation

 Repeater mode is not supported.

![image-20210903142430433](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/140b094e4a4fd52e35ca139ef11fde66.png)

### 3.3 TX Output Power Encoding4

![image-20210903142455957](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/b7b5fa38f88f6e7eb301be0c3b45c442.png)

[^]:  LoRaWAN V1.0.3 US915 / AU915 band supports TxPower maximum 15 
[^]: 12.15dBm is set to 12dBm, MaxEIRP Index 2
[^]: 19.15dBm is converted to 20dBm, MaxEIRP Index 7



![image-20210903143535561](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/05db38057337260fd1e9c121be6269eb.png)

[^]: TXPower is defined in LoRaWAN specification Mac command LinkADRReq chapter.

### 3.4 Channels

#### 3.4.1 Default Uplink Channels

![image-20210903143628058](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/f34f95b74a97220d12a3d4aab8a5ce2b.png)

#### 3.4.2 Downlink RXWIN1 Channels

Downlink Data Rate is defined by RX1DROffset.

![image-20210903143917460](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/351bf64ebb84013d44837d0d1ba92202.png)

[^]: 12.15dBm is set to 12dBm, MaxEIRP Index 2
[^]: 19.15dBm is converted to 20dBm, MaxEIRP Index 7

![image-20210903144051454](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/4e67dfb88fa57eab15f312e8a03cc333.png)

### 3.4.3 Downlink RXWIN2 Channel

![image-20210903144124316](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/2cd40cf83731f17f2073ecf83517dc48.png)

### 3.4.4 Join Request Channels

![image-20210903144217548](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/3c936c485c038359bdd1095d9e0d1b44.png)

**Note: Although the modem supports user to modify the default uplink channels, it does not encourage user to do so. If user need modify the default channels, please make sure gateway and server supports the selected channel.**

### 3.5 Join Duty Cycle Limitation

The latest V2.1.x (or higher) firmware enables the global JoinReq duty cycle which applies below table9 .

![image-20210903144609621](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/7b4496e8635d1b75e67ad6de90c37878.png)

"AT+LW=JDC, OFF" command could be used to disable the feature if user need to disable the feature

### 3.6 RX1DROffset Limitation

|RX1DROffset |EU868 |US915| US915|
|--------|-----|-----|--------|
|HYBRID |CN779 |EU433 |AU915 |AU915OLD |CN470 |AS923 |KR920 |IN865 |CN470|PREQUEL |STE920|
|Min |0| 0 |0| 0 |0| 0 |0| 0 |0| 0 |0| 0 |0|
|Max| 5 |3| 3 |5| 5 |5| 3 |5| 7 |5| 7 |5| 5|

Default RX1DROffset of all bands is 0.

#### 3.6.1 EU868/EU434/CN470 /KR920/CN470PREQUEL/STE920

   DR = MAX( UplinkChannelDaraRate - RX1DROffset, DR0)

#### 3.6.2 US915/ US915HYBRID/AU915

DR = MAX( MIN( UplinkChannelDaraRate +10 - RX1DROffset, DR13 ), DR8 )

#### 3.6.3 AS923

MIN( 5, MAX( MinDR, UplinkChannelDaraRate - Effective_RX1DROffset ) )

MinDR depends on the DownlinkDwellTime bit sent to the device in the TxParamSetupReq command: 

- Case DownlinkDwellTime = 0 (No limit): MinDR = DR0 

-  Case DownlinkDwellTime = 1 (400ms): MinDR = DR2

![image-20210903145134145](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/b135d0dbb7cc6ccede1efdc8e23971cb.png)

#### 3.6.4 IN865

MIN( 5, MAX( 0, UplinkChannelDaraRate - Effective_RX1DROffset ) )

![image-20210903145204823](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/765866908fd133688cead9d40153781a.png)

### 3.7 CFLIST

![image-20210903145242750](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/d4054e7effa68029d661daa3a2c25c6d.png)

LoRaWAN V1.0.3 US915 / US915 / CN470 supports to use CFLIST to management channel (ChMask).



### 3.8 LinkAdrReq

![image-20210903145304655](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/b67849e55478cfb95516564b06bf864c.png)

### 3.9 Band Specific Limitation

#### 3.9.1 US915/AU915/CN470 Channel Limitation

Under these modes, up to 72 (US915/AU915) or 96 (CN470) channels could be enabled. All these channels are not configurable with the default channels according to the definition of LoRaWAN 1.0.1. This means below commands will be invalid:

```
AT+CH=ch, freq, [drmin], [drmax]

AT+RXWIN1=ch, freq
```

To turn on/off channel, user need to use AT+CH=NUM or AT+CH=ch, ON/OFF command.



#### 3.9.2 EU868 Duty Cycle Limitation

Only EU868 band need enable duty cycle limitation to comply with ETSI [EN300.220] standard. Band and limitation is defined as below

![image-20210903145432448](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/1b60f55e0366380f88e065bbab730464.png)

[^]: Here has some difference from LoRaWAN specification use 4-8 to define, by which it assume first channel has index 1. RisingHF device use index 0 for the first channel.
[^]: LoRaWAN V1.0.3 Only

![image-20210903145512970](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/fc98d94da98a865a5bac3a6b4e67b123.png)

#### 3.9.3 CN799 Duty Cycle Limitation

![image-20210903145533293](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/7e51a755d1b8b78e67d5fb0a46ca50a3.png)

#### 3.9.4 EU433 Duty Cycle Limitation 

![image-20210903145617253](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/0f86f7b90ca4831b7bf74db5753d270e.png)

#### 3.9.5 AS923 Dwell Time Limitation

![image-20210903145830829](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/62f242593ee7eeacff8aa4caba45ae93.png)



#### 3.9.6 AS923 Dwell Time Limitation

UplinkDwellTime, DownlinkDwellTime and MaxEIRP can be set configured through TxParamSetupReq / TxParamSetupAns MAC command.

![image-20210903145935715](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/540117a7868d31a60fc952bee5f7cf0b.png)

#### 3.9.7KR920 Channels and TX Power Limitation

For KR920 band, only below channels are available.

![image-20210903150114357](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/14b0890f12f65ed961ff69fbbcd2a495.png)

#### 3.10 Band Frequency Range

![image-20210903150147004](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/979154a3d3ad94541fb859d9b00771ea.png)

![image-20210903150210875](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/41b38af0c56b4dc1ac0a668973e2c00c.png)

##### 3.10.1 AS923 Region Limitation

![image-20210903150242453](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/0de9147f14297412667408a0090d30fb.png)

#### 3.11 Class B

##### 3.11.1 Default Parameters

![image-20210903150345134](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/a579be43e36fc62a9cfbbca5dc4b5bd2.png)

Beacon channel index number at specified beacon time can be calculated with formula:
$$
ch = floor(beacon_time/beacon_period) % ChannelNum
$$

[^]: Defined by LoRaWAN 1.0.2 Regional Parameter

##### 3.11.2 Beacon Frame Content

LoRaWAN V102B and V103: 

![image-20210903150819701](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/8de106b054527cdcd8d6bd408551c074.png)

LoRaWAN V102 (Time is in UTC epoch format)

![image-20210903150846915](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/338f6dec503751a669e50c766d20e3af.png)

##### 3.11.3 Periodicity

Periodicity is a very important Class B parameter to control ping slot numbers and ping slot timing. Periodicity is set to 5 by default. AT+BEACON=periodicity command can be used to configure periodicity.

![image-20210903151016228](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/13adac7402f35fa16de88394619603ad.png)





## 4 Commands


|Command |Description|
|--------|-----|
|AT |Test command|
|FDEFAULT |Factory data reset|
|RESET| Software reset|
|DFU |Force bootloader to enter dfu mode|
|LOWPOWER |Enter sleep mode|
|VER |Version[Major.Minor.Patch]|
|MSG |LoRaWAN unconfirmed data|
|MSGHEX| LoRaWAN unconfirmed data in hex|
|CMSG |LoRaWAN confirmed data|
|CMSGHEX |LoRaWAN confirmed data in hex|
|PMSG |LoRaWAN proprietary|
|PMSGHEX |LoRaWAN proprietary in hex|
|CH |LoRaWAN channel frequency|
|DR|LoRaWAN datarate |
|ADR |LoRaWAN ADR control|
|REPT |Unconfirmed message repetition|
|RETRY |Confirmed message retry|
|POWER |LoRaWAN TX power|
|RXWIN2 |LoRaWAN RX window2|
|RXWIN1 |LoRaWAN RX window1|
|PORT |LoRaWAN communication port|
|MODE| LWABP, LWOTAA, TEST|
|ID |LoRaWAN DevAddr/DevEui/AppEui|
|KEY |Set NWKSKEY/APPSKEY/APPKEY|
|CLASS |Choose LoRaWAN modem class(A/B/C)|
|JOIN |LoRaWAN OTAA JOIN|
|LW |LoRaWAN misc configuration (CDR, ULDL, NET, DC, MC, THLD)|
|BEACON| LoRaWAN Class B utilities|
|TEST |Send test serious command|
|UART |UART configure|
|DELAY |RX window delay|
|VDD |Get VDD|
|RTC |RTC time get/set|
|EEPROM |Write/Read EEPROM|
|WDT |Watchdog control|
|TEMP |Get Temperature|
|LOG |Log DEBUG/INFO/WARN/ERROR/FATAL/PANIC/QUIET|

### 4.1 AT

Use to test if connection of module is OK. This is a dummy command just like other common "AT modules"

```
Format:

  AT 

Return: +AT: 

OK

```



### 4.2 VER

Check firmware version. Versioning rule refers to Semantic Versioning 2.0.0

```
Format:
AT+VER
Return:
+VER: $MAJOR.$MINOR.$PATCH
+VER: 2.1.x
```

### 4.3 ID

Use to check the ID of the LoRaWAN module, or change the ID. ID is treated as big endian numbers. Read ID Format:

```
AT+ID // Read all, DevAddr(ABP), DevEui(OTAA), AppEui(OTAA)
AT+ID=DevAddr // Read DevAddr
AT+ID=DevEui // Read DevEui
AT+ID=AppEui // Read AppEui
AT+ID=DevAddr, "devaddr" // Set new DevAddr
AT+ID=DevEui, "deveui" // Set new DevEui
AT+ID=AppEui, "appeui" // Set new AppEui
Return:
+ID: DevAddr, xx:xx:xx:xx
+ID: DevEui13, xx:xx:xx:xx:xx:xx:xx:xx
+ID: AppEui14, xx:xx:xx:xx:xx:xx:xx:xx
```

Change end device address (DEVADDR)

```
ge end device address (DEVADDR)
AT+ID=DevAddr, “4 bytes length hex identifier”
eg: AT+ID=DevAddr, "01234567"
eg: AT+ID=DEVADDR, "01 23 45 67"
Return:
+ID: DevAddr, 01:23:45:67
```

Change device extended unique identifier (DEVEUI)

```
AT+ID= DevEui, “8 bytes length hex identifier (64bits)”
eg: AT+ID=DevEui, "0123456789ABCDEF"
eg: AT+ID=DEVEUI, "01 23 45 67 89 AB CD EF"
Return:
+ID: DevEui, 01:23:45:67:89:AB:CD:EF
```

[^]: DevEui which is supplied by RisingHF are derived from STM32's UUID, these EUIs are RisingHF unique is not standard IEEE EUI-64, , it is recommended to apply and use IEEE-EUI64.
[^]: Default AppEui is 52:69:73:69:6E:67:48:46

Change device extended unique identifier (APPEUI)

```
AT+ID= AppEui, “8 bytes length hex identifier (64bits)”
eg: AT+ID=AppEui, "0123456789ABCDEF"
eg: AT+ID=APPEUI, "01 23 45 67 89 AB CD EF"
Return:
+ID: AppEui, 01:23:45:67:89:AB:CD:EF
```

### 4.4 RESET

Use to reset the module. If module returns error, then reset function is invalid. 

```
Format:
AT+RESET
Return:
+RESET: OK
```

### 4.5 MSG

Use to send string format frame which is no need to be confirmed by the server.

```
Format:
AT+MSG="Data to send"
Return: (Full return message)
+MSG: Start
+MSG: FPENDING
+MSG: Link 20, 1
+MSG: ACK Received
+MSG: MULTICAST
+MSG: PORT: 8; RX: "12345678"
+MSG: RXWIN215, RSSI -106, SNR 4
+MSG: Done
Below return messages are optional, it is returned only in the cases that specified event occurs.
+MSG: FPENDING // Downlink frame FPENDING flag is set
+MSG: Link 20, 1 // LinkCheckAns received
+MSG: ACK Received // Downlink frame ACK flag is set
+MSG: MULTICAST // Downlink frame is multi cast message
+MSG: PORT: 8; RX: "12345678" // Downlink message is received
+MSG: RXWIN2, RSSI -106, SNR 4 // Downlink frame signal strength

```

[^]: RXWIN2: Message is received during RX Window2; RXWIN1: RX Window1; RXWIN0: Class C Extra RXWIN2.

#### 4.5.1 LinkCheckReq

AT+MSG could be used to send LinkCheckReq mac command to check Link status between modem and server.

```
AT+MSG
+MSG: Start
+MSG: TX ""
+MSG: Link 20, 1
+MSG: RXWIN1, RSSI -93, SNR 6.25
+MSG: Done
```

From example above, the modem returns “+MSG: Link 20, 1” to host, it is in the format:
+MSG: Link Margin, GwCnt
The demodulation margin (Margin) is an 8-bit unsigned integer in the range of 0..254 indicating the link
margin in dB of the last successfully received LinkCheckReq command.
A value of “0” means that the frame was received at the demodulation floor (0 dB or no margin) while a
value of “20”, for example, means that the frame reached the gateway 20 dB above the demodulation
floor. Value “255” is reserved.

The gateway count (GwCnt) is the number of gateways that successfully received the last LinkCheckReq
command.

#### 4.5.2 Error Status

```
1. LoRaWAN transaction service is ongoing
+MSG: LoRaWAN modem is busy
2. LoRaWAN modem is in OTAA mode and not joined a network
+MSG: Please join network first
3. LoRaWAN modem already joined to a network previously
+JOIN: Joined already
Note: use AT+JOIN=FORCE to force join if needed.
4. All configured channels are occupied by others.
+MSG: No free channel -70
Note: use AT+LW=THLD to set a new threshold
5. There is no band available for the moment. The modem must stay silence for a while, because of
local regulation rules or Join Request Duty Cycle
+MSG: No band in 13469ms
6. Current DR set data rate is not supported
+MSG: DR error
Note: use AT+DR=dr to set a new datarate
7. Current payload length is too long to send.
+MSG: Length error N
Note: N could be 0 or none zero value, if it returns 0, it means there is a pending
Uplink MAC Command must be sent through Port 0. User need send a dummy MSG command "AT+MSG"
to flush uplink MAC command.
```

It is recommended for use to run AT+LW=LEN command to get maximum available payload size. And make sure the next packet payload length is less than the available maximum payload length.

Note: use AT+LW=LEN command to get current available length.

### 4.6 CMSG

Use to send string format frame which must be confirmed by the server. Format:

```
AT+CMSG="Data to send"
Return: (Full return message)
    +CMSG: Start
    +CMSG: Wait ACK
    +CMSG: FPENDING
    +CMSG: Link 20, 1
    +CMSG: ACK Received
    +CMSG: MULTICAST
    +CMSG: PORT: 8; RX: "12345678"
    +CMSG: RXWIN216, RSSI -106, SNR 4
    +CMSG: Done
Below return messages are optional, it is returned only in the cases that specified event occurs.
    +CMSG: FPENDING // Downlink frame FPENDING flag is set
    +CMSG: Link 20, 1 // LinkCheckAns received
    +CMSG: ACK Received // Downlink frame ACK flag is set
    +CMSG: MULTICAST // Downlink frame is multi cast message
    +CMSG: PORT: 8; RX: "12345678" // Downlink message is received
    +CMSG: RXWIN2, RSSI -106, SNR 4 // Downlink frame signal strength

```

### 4.7 MSGHEX

Use to send hex format frame which is no need to be confirmed by the server.

```
Format:
AT+MSGHEX="xx xx xx xx"
eg: AT+MSGHEX="12345678"
Return:
+MSGHEX: Start
+MSGHEX: Done
```

For detailed examples, please refer to MSG. MSG and MSGHEX are the same command except payload format.

#### 4.7.1 Send Unconfirmed Message with Zero Length Payload

```
Format:
AT+MSGHEX
eg: AT+MSGHEX
Return:
+MSGHEX: Start
+MSGHEX: Done
```

[^]: RXWIN2: Message is received during RX Window2; RXWIN1: RX Window1; RXWIN0: Class C Extra RXWIN2.

### 4.8 CMSGHEX

Use to send hex format frame which must be confirmed by the server.

```
Format:
AT+CMSGHEX="Data to send"
eg: AT+CMSGHEX="12345678"
Return:
+CMSGHEX: Start
+CMSGHEX: Wait ACK
+CMSGHEX: Done

```

For detailed examples, please refer to CMSG. CMSG and CMSGHEX are the same command except payload format.

#### 4.8.1 Send Confirmed Message with Zero Length Payload

```
Format:
AT+CMSGHEX
eg: AT+CMSGHEX
Return:
+CMSGHEX: Start
+CMSGHEX: Wait ACK
+CMSGHEX: Done
```

### 4.9 PMSG 

Use to send string format LoRaWAN proprietary frames. 

```
Format:
AT+PMSG="Data to send"
eg: AT+PMSG="This is a string"
Return:
+PMSG: Start
+PMSG: Done

```

### 4.10 PMSGHEX

Use to send hex format LoRaWAN proprietary frames.

```
Format:
AT+PMSGHEX="Data to send"
eg: AT+PMSGHEX="AB CD"
Return:
+PMSGHEX: Start
+PMSGHEX: Done
```

### 4.11 PORT

Set PORT number which will be used by MSG/CMSG/MSGHEX/CMSGHEX command to send message, port number should range from 1 to 255. User should refer to LoRaWAN specification to choose port.

```
Format:
AT+PORT="port" // "port" should be 1~255
eg: AT+PORT=8 // Set port to 8
eg: AT+PORT=? // Check current port
Return:
+PORT: 8 // PORT query/set return
```

### 4.12 ADR

Set ADR function of LoRaWAN module.

```
Format:
AT+ADR="state"
eg: AT+ADR=ON // Enable ADR function
AT+ADR=OFF // Disable ADR function
AT+ADR=? // Check current ADR configuration
Return:
+ADR: ON // ADR query/set return
```

### 4.13 DR

Use LoRaWAN defined DRx to set datarate of LoRaWAN AT modem. Refer to Chapter 3 Band Plans about the detailed definition of LoRaWAN data rate.

#### 4.13.1 Check and Set Data Rate

```
Format:
AT+DR // Check current selected DataRate
AT+DR=drx // "drx" should range 0~15
Return:
+DR: DR0
+DR: US915 DR0 SF10 BW125K
Return: (ADR is functional)
+DR: DR0 (ADR DR3)
+DR: US915 DR3 SF7 BW125K
+DR: US915 DR0 SF10 BW125K
```

#### 4.13.2 Data Rate Scheme

```
Format:
AT+DR=band // "band" could be band names defined in Chapter 3 Band Plans
AT+DR=SCHEME // Check current band
Return: (EU868)
+DR: EU868
+DR: EU868 DR0 SF12 BW125K
+DR: EU868 DR1 SF11 BW125K
+DR: EU868 DR2 SF10 BW125K
+DR: EU868 DR3 SF9 BW125K
+DR: EU868 DR4 SF8 BW125K
+DR: EU868 DR5 SF7 BW125K
+DR: EU868 DR6 SF7 BW250K
+DR: EU868 DR7 FSK 50kbps
+DR: EU868 DR8 RFU
+DR: EU868 DR9 RFU
+DR: EU868 DR10 RFU
+DR: EU868 DR11 RFU
+DR: EU868 DR12 RFU
+DR: EU868 DR13 RFU
+DR: EU868 DR14 RFU
+DR: EU868 DR15 RFU

```

### 4.14 CH

#### 4.14.1 Query Channel Configuration

```
Format:
AT+CH
AT+CH=ch
1. Check single channel frequency
eg: AT+CH=2
+CH: 2,868500000,DR0:DR5
2. Query all channels
AT+CH
Query All Channels Return Format:
+CH: TOTAL_CHANNEL_NUMBER; LCn,FREQn,DR_MINn,DR_MAXn; LCy,FREQy,DR_MINy,DR_MAXy; ...
LCz,FREQz,DR_MINz,DR_MAXz;
eg: +CH: 3; 0,868100000,DR0,DR5; 1,868300000,DR0,DR5; 2,868500000,DR0,DR5;
```

#### 4.14.2 Add or Delete Channel

```
Set channel parameter of LoRaWAN modem, Set frequency zero to delete one channel.
Format:
AT+CH="chn", ["freq"], ["drmin"], ["drmax"]
// Change the chn channel frequency to "Freq"
// "freq" is in MHz.
// Available "drmin"/"drmax" range DR0 ~ DR15
1. Change channel CH3 frequency to 433.3MHz, datarate DR0~DR5
eg: AT+CH=3, 433.3, DR0, DR5
2. Delete channel CH3
eg: AT+CH=3, 0
3. Change channel CH0 frequency to 433.3MHz,DR7
eg: AT+CH=0, 433.3, DR7
4. Change channel CH3 frequency to 433.7MHz, datarate DR0~DR5
eg: AT+CH=3, 433.7, 0, 5
5. Change channel CH3 frequency to 433.7MHz, datarate DR7
eg: AT+CH=3, 433.7, DR7
6. Change channel CH3 frequency to 433.7MHz, with default datarate DR0~DR5
eg: AT+CH=?
eg: AT+CH=3, 433.7
// It is not recommended to use this command
Return:
+CH: 3,433700000,DR0:DR5
+CH: 3,433700000,DR1
```

#### 4.14.3 Enable or Disable Channel

```
Format:
AT+CH=NUM
AT+CH=NUM, chm-chn, ..., chx-chy, chz
1. Check current enabled channels
eg: AT+CH=NUM
+CH: NUM, 0-7, 64
2. Enable and disable channels
eg: AT+CH=NUM, 0-5, 64 // Enable channel 0, 1, 2, 3, 4, 5 and 64, disable all others
+CH: NUM, 0-5, 64
Note: All channels should be controlled by a single command. The command operates all channels (0-
95).
3. Enable single channel
eg: AT+CH=chn,ON
4. Disable single channel (channel is just masked, not deleted)
eg: AT+CH=chn,OFF
```

### 4.15 POWER

#### 4.15.1 Set and Check Power

LoRaWAN TX power is controlled by internal TX power table, and also decided by hardware. Check TX power table to know what power could support.

```
Format:
AT+POWER
AT+POWER="pow" // Change LoRaWAN Tx Power
eg: AT+POWER=14 // Change LoRaWAN AT module TX power to 14dBm
Return:
+POWER: 14

```

#### 4.15.2 Force Set Power

This command can be used to set a fixed TX power for LoRaWAN modem, it will bypass LoRaWAN TX power table and LinkADRReq command. 

```
Format:
	AT+POWER=pow, FORCE
```

#### 4.15.3 Power Table

This command can be used to check band specific power table. 

```
This command can be used to check band specific power table. 
```

### 4.16 REPT

Unconfirmed message repeats times.

```
Format:
AT+REPT="Repeat Times" //Repeat times" should range 1~15
eg: AT+REPT=2 //Repeat 2 times
Return:
+REPT: 2
```

### 4.17 RETRY

Confirmed message retry times. Valid range 0~254, if retry times is less than 2, only one message will be sent. Random delay 3 - 10s between each retry (band duty cycle limitation has the priority)

```
Format:
AT+RETRY="Retry Times" //Retry times" should range 0~15
eg: AT+RETRY=3 //Retry 2 times (3-1), if no ack receive
Return:
+RETRY: 3
```

### 4.18 RXWIN2

Set second RX window frequency and Data Rate. This command will change RXWIN2 configuration, which may cause downlink lost, if configuration is wrong.

```
Format:
AT+ RXWIN2 // Query RX Window2 configuration
AT+RXWIN2=Frequency,DRx // Set frequency and datarate
AT+RXWIN2=Frequency,SFx,BW // Set RXWIN2 through SF and BW
eg: AT+RXWIN2=433.3,DR3 // Set RXWIN2 433.3MHz/DR3
eg: AT+RXWIN2=433.3,SF7,500 // Set RXWIN2 433.3MHz/SF7/BW500KHz
Return:
// General data rate
+RXWIN2: 433300000,DR5
// Customized RX Window2 data rate with spread factor and band width
+RXWIN2: 433000000,SF7,BW125K

```

From firmware 1.8.0, RXWIN2 command could support more flexible configuration. Both LoRaWAN
defined data rate (combination of spread faction and band width) and LoRa defined spread factor and
band width format are supported. User could set his RXWIN2 to any possible SF and BW scheme,
which is a very useful function for LoRaWAN proof of concept.

### 4.19 RXWIN1

RXWIN1 command could be used to set customized RXWIN channel, each RXWIN channel maps to
an uplink channel. When RXWIN1 is enabled, user need make sure every uplink channel has its own
mapped RXWIN1 channel, or the modem may perform unexpected.
**With this special RXWIN1 command, frequency shift between uplink and downlink becomes**
**possible, then full-duplex is easy to achieve for the system if gateway supports.**

```
a) Set RXWIN1
AT+RXWIN1=ch,freq
eg: AT+RXWIN1=0,868.9
Set none zero freq to overwrite default RXWIN1 channel frequency.
Set zero freq to use default frequency
b) Query RXWIN1 channel
AT+RXWIN1=ch
eg: AT+RXWIN1=0,868100000
c) Check RXWIN1
AT+RXWIN1
+RXWIN1: 3; 0,868100000; 1,868300000; 2,868500000;
```

AT+RXWIN1 and its subcommands always returns the channels which are enabled currently. If customized downlink channel is zero, then default downlink channels will be used.

### 4.20 KEY

Change LoRaWAN related AES-128 KEY. If wrong key is used, your LoRaWAN modem will be rejected by LoRaWAN server. Contact server administrator to know what key should use. All KEYs are unreadable for security, the one who forgets his KEY need rewrite with a new key.

```
Format:
Change network session key (NWKSKEY)
AT+KEY=NWKSKEY, “16 bytes length key”
eg: AT+KEY=NWKSKEY, "2B7E151628AED2A6ABF7158809CF4F3C"
eg: AT+KEY=NWKSKEY, "2B 7E 15 16 28 AE D2 A6 AB F7 15 88 09 CF 4F 3C"
Return:
+KEY: NWKSKEY 2B7E151628AED2A6ABF7158809CF4F3C
Change application session key (APPSKEY)
AT+KEY=APPSKEY, “16 bytes length key”
eg: AT+KEY=APPSKEY, "2B7E151628AED2A6ABF7158809CF4F3C"
eg: AT+KEY= APPSKEY, "2B 7E 15 16 28 AE D2 A6 AB F7 15 88 09 CF 4F 3C"
Return:
+KEY: APPSKEY 2B7E151628AED2A6ABF7158809CF4F3C
Change application session key (APPKEY)
AT+KEY=APPKEY, “16 bytes length key”
eg: AT+KEY=APPKEY, "2B7E151628AED2A6ABF7158809CF4F3C"
 AT+KEY= APPKEY, "2B 7E 15 16 28 AE D2 A6 AB F7 15 88 09 CF 4F 3C"
Return:
+KEY: APPKEY 2B7E151628AED2A6ABF7158809CF4F3C
```

### 4.21 FDEFAULT

Reset LoRaWAN AT modem to factory default configuration.

```
Format:
AT+FDEFAULT
AT+FDEFAULT=RISINGHF
Return:
+FDEFAULT: OK
```
|Item |Value|
|--------|-----|
|Mode| LoRaWAN ABP|
|Channel |3 default channels 868.1MHz 868.3MHz 868.5MHz|
|Datarate Range |DR0 : DR5|
|Unconfirmed Message Repetition |1|
|Confirmed Message Retry |3|
|Port |8|
|Datarate |DR0|
|ADR |ON|
|Power |14dBm|
|RXWIN2 |869.525MHz, DR0|
|RXWIN1 Delay |1s|
|RXWIN2 Delay |2s|
|JOIN ACCEPT RXWIN1 |Delay 5s|
|JOIN ACCEPT RXWIN2 |Delay 6s|
|Listen Before Talk Threshold |-85dBm|
|EU868 Duty Cycle Limitation |OFF|
|LoRaWAN Public Network |ON|
|NwkSKey |2B7E151628AED2A6ABF7158809CF4F3C|
|AppSKey |2B7E151628AED2A6ABF7158809CF4F3C|
|AppKey |2B7E151628AED2A6ABF7158809CF4F3C|
|AppEui |52:69:73:69:6e:67:48:46|
|Uplink |Counter 1|
|Downlink |Counter 0|
|Multicast |OFF|


[^NOTE]: Customized modem may be precompiled to use a different factory default configuration. If any user has request, please contact

### 4.22 DFU

Use to enter DFU mode. If user need to enter DFU mode to update LoRaWAN modem firmware, then
user should first send "AT+DFU=ON" command to enable firmware upgrade. Once DFU mode is on,
user should repower LoRaWAN modem (unplug and plug back), after repowered LoRaWAN will enter
DFU mode, user could use DfuSe tool to update the firmware. If user want to exit DFU mode without
upgrade, user just need to repower again, LoRaWAN modem will exit DFU mode automatically.
For UART bootloader, "AT+DFU=ON" command will make device enter bootloader mode automatically.
For USB bootloader, after "AT+DFU=ON" command, user need restart device manually

```
Format:
AT+DFU="New state"
eg: AT+DFU=ON // Enable DFU function
eg: AT+DFU=OFF // Disable DFU function
AT+DFU=? // Check if DFU is enabled configuration
Return:
+DFU: ON
+DFU: OFF
Example:
+DFU: ON

```

[^]: DFU mode is risky. Before updating, user must make sure the firmware is supplied by RisingHF, a wrong firmware may brick LoRaWAN modem.

### 4.23 MODE

Use to select work mode. LWABP17, LWOTAA18, TEST are supported. LoRaWAN modem can only
work with one mode at a time. By default, LWABP is enabled, all test commands are unavailable,
LoRaWAN will return error(-12) if it receives test command in non-test mode.
"AT+MODE" command will reset LoRaWAN stack when first enter LWABP/LWOTTA mode and reset
LoRa chip when first enter test mode.
LWABP/LWOTAA mode status is remembered by LoRaWAN modem, each time LoRaWAN modem
starts, it will enter previous working mode before reset or repower.

```
Format:
AT+MODE="mode"
eg: AT+MODE=TEST // Enter TEST mode
eg: AT+MODE=LWOTAA // Enter LWOTAA mode
eg: AT+MODE=LWABP // Enter LWABP mode
Return
+MODE: LWABP // Enter LWABP mode successfully
+MODE: LWOTAA // Enter LWOTAA mode successfully
+MODE: TEST // Enter TEST mode successfully
```

### 4.24 JOIN

When OTAA mode is enabled, JOIN command could use to join a known network.

```
Format:
AT+JOIN
AT+JOIN=FORCE
```

[^]: LWABP is short for LoRaWAN Activation By Personalization. Check < LoRaWAN™ Specification> for details
[^]: LWOTAA is short for LoRaWAN Over-The-Air-Activation.

```
1.Join
eg: AT+JOIN // Send JOIN request
2. Disconnect with current network, force send one JOIN request
eg: AT+JOIN=FORCE
3. Returns
a) Join successfully
+JOIN: Starting
+JOIN: NORMAL
+JOIN: NetID 000024 DevAddr 48:00:00:01
+JOIN: Done
b) Join failed
+JOIN: Join failed
c) Join process is ongoing
+JOIN: LoRaWAN modem is busy
```

#### 4.24.1 Auto Join  

```
Format:
AT+JOIN=period // period: 0 - 172800s, 0 to disable auto jioin.
AT+JOIN=FORCE
1. Enable auto Join 1min
eg: AT+JOIN=60
2. Disable auto join
eg: AT+JOIN=0
In auto join mode host could still detect below format URC message to know device is connected
+JOIN: NetID 000024 DevAddr 48:00:00:01
+JOIN: Done
```

### 4.25 BEACON

#### 4.25.1 AT+BEACON

Set beacon and ping slot configuration

```
AT+BEACON=periodicity,[DRx],[psfreq],[DRx,bfreq] // Set beacon configuration
// periodicity: pingSlotPeriod factor (pingSlotPeriod = 2periodicity seconds)
// DRx: Data rate
// psfreq: Ping slot frequency
// bfreq: Beacon frequency
// []: The field is omissible with all appended fields
```

Query beacon and ping slot configuration

```
AT+BEACON
+BEACON: periodicity,DRx,psfreq,DRx,bfreq
```

#### 4.25.2 AT+BEACON=DMMUL

Dummy uplink control. Before switching to Class B mode, dummy uplink is supported by device to get configuration information. By default, dummy uplink is turned off. 

```
AT+BEACON=DMMUL,num,period
num: 0 to disable, others to enable exact number of dummy uplinks, 0 ~ 255
period: uplink period, 5 ~ 17280s
AT+BEACON=DMMUL, 0, 15

```

#### 4.25.3 AT+BEACON=INFO

Get beacon description information. Includes NetID, GatewayID, Gateway Coordinate

```
AT+BEACON=INFO
+BEACON: INFO, netid, gwid, longitude, latitude
netid: 3 bytes hex
gwid: 3 bytes hex
longitude: positive for east, negative for west. 123.124037 (East)
latitude: positive for north, negative for south. 89.002293 (North)
```

#### 4.25.4 AT+BEACON=GWGPS

Get gateway GPS coordinate from last received beacon. 

```
AT+BEACON=GWGPS
+BEACON: GWGPS, 123.124037, 89.002293
 // 123.124037 Longitude (East)
 // 89.002293 Latitude (North)
```

#### 4.25.5 Switch to Class B mode

![image-20210903161026329](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/b5470c89bb13b53c4bdad645fc0d0c81.png)





Command flow:

1. AT+CLASS=B
2. Wait +BEACON: LOCKED
3. Wait +BEACON: DONE
4. Device is now in Class B mode
5. When in Class B mode host should be responsible to monitor “+BEACON: LOST” event, when it
occurs, which means device switch to Class A due to Beacon lost issue
6. If no beacon found during Class B switching process, “+BEACON: FAILED” is sent to host.
7. Current class mode is checkable through AT+CLASS command

Notification, will be triggered when the event occur.

```
+BEACON: LOCKED // Beacon found and synced
+BEACON: FAILED // Fail to switch to Class B
+BEACON: DONE // Success to switch to Class B
+BEACON: LOST // Beacon lost, switch back to Class A
```

#### 4.25.5.1 ABP

Execute class switch AT command “AT+CLASS=B”, the modem will negotiate with server automatically.

```AT+CLASS=B```

When beacon is found, “+BEACON: LOCKED” message is notified.

```+BEACON: LOCKED```

When ping slot information is exchanged, “+BEACON: DONE” message is notified. At this time ping slots will be opened periodically

```+BEACON: DONE```

If there is not beacon is found in 128s, “+BEACON: FAILED” will be notified
If there is not beacon is found in 2 hour after beacon locked, “+BEACON: LOST” will be notified.



#### 4.25.5.2 OTAA

Switch to OTAA mode.
```AT+MODE=LWOTAA```
Trigger AT+JOIN command to try to join the known LoRaWAN network.
```AT+JOIN```
Other information are the same as chapter 4.25.5.1 ABP. 

### 4.26 CLASS

This command could enable LoRaWAN modem to work at different mode (Class A/B19/C). LoRaWAN
modem works at class A mode when power on, user need manually switch mode to class B/C as
needed.
Format:

``` 
eg: AT+CLASS=A // Enable Class A mode
eg: AT+CLASS=B // Enable Class B mode
eg: AT+CLASS=C // Enable Class C mode 
```

Query class type:
``` AT+CLASS```

```
+CLASS: A
+CLASS: C
+CLASS: B
+CLASS: B (Sx) // Class B switching ongoing
```

##### 4.26.1 Class C Downlink

Class C mode will reuse RXWIN2 configuration. Check with "AT+RXWIN2". If downlink is received,
below message could be returned to host.

```

+MSG: FPENDING
+MSG: Link 20, 1
+MSG: ACK Received
+MSG: MULTICAST
+MSG: PORT: 8; RX: "12345678"
+MSG: RXWIN0, RSSI -106, SNR 4
+MSG: Done
```

##### 4.26.2 Class B Downlink

```

Check with "AT+BEACON" current beacon and ping slot configuration. If downlink is received, below
message could be returned to host. RXWIN3 stands for ping slot received packet.
+MSG: FPENDING
+MSG: Link 20, 1
+MSG: ACK Received
+MSG: MULTICAST
+MSG: PORT: 8; RX: "12345678"
+MSG: RXWIN3, RSSI -106, SNR 4
+MSG: Done

```

##### 4.26.3 Class B Status

```

+CLASS: B (S0) // (Status 0, Beacon timing request)
+CLASS: B (S1) // (Status 1, Beacon searching)
+CLASS: B (S2) // (Status 2, Ping slot information request)
+CLASS: B (S3) // (Status 3, Failed)
+CLASS: B (S4) // (Status 4, Not synced)
+CLASS: B (S5) // (Status 5, Network not joined)
+CLASS: B (S6) // (Status 6, LoRaWAN is busy)
+CLASS: B (S7) // (Status 7, Send dummy uplink)
+CLASS: B // (Class B mode enabled)
```

### 4.27 DELAY

RX window delay configuration command. Supports configure RECEIVE_DELAY1, RECEIVE_DELAY2,
JOIN_ACCEPT_DELAY1, JOIN_ACCEPT_DELAY2.

![image-20210903161704746](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/2b16d1f2c4de17009628b41edd5e5158.png)

```
Format:
// Query delay settings
AT+DELAY
AT+DELAY?
AT+DELAY=?
// Set delay
AT+DELAY=RX1, 1000 // Unit: ms
AT+DELAY=RX2, 2000
AT+DELAY=JRX1, 5000
AT+DELAY=JRX2, 6000
Return:
+DELAY RX1, 1000
+DELAY RX2, 2000
+DELAY JRX1, 5000
+DELAY JRX2, 6000
```

### 4.28 LW

LW commands is a collection of several LoRaWAN control commands. Include CDR, ULDL, DC, NET,
MC, THLD. BAT, TPS, SCR, JDC, LEN.

##### **4.28.1 CDR**

CDR command could be used to get current TX/RX available data rate range.
Format:
```AT+LW=CDR, [ UL_DR_MIN, UL_DR_MAX, DL_DR_MIN, DL_DR_MAX ]```

1. Check current datarate limitation

```
AT+LW=CDR
+LW: CDR, TXDR(0,7), RXDR(0,7) //EU868
+LW: CDR, TXDR(0,4), RXDR(8,13) //AU920
```

##### **4.28.2 ULDL**

Set and read uplink and downlink counter.

Format:
``` AT+LW=ULDL, UL_COUNTER, DL_COUNTER```

1. Read counter

  ```
  AT+LW=ULDL
  +LW: ULDL 1, 0
  ```

  

2. Set counter

  ```
  AT+LW=ULDL, 5, 10
  +LW: ULDL 5, 10
  ```

##### **4.28.3 DC**

EU868 Duty Cycle limitation and LoRaWAN Transmit Duty Cycle control interface. This option is
mandatory to be set to on, when using in Europe to follow ETSI regulation. And this command could 
also be used to set a specify value for MaxDCycle, valid range 0 ~ 15. And the tansmit aggregated
duty cycle is allowed by:
$$
𝑨𝒈𝒈𝒓𝒆𝒈𝒂𝒕𝒆𝒅𝑫𝒖𝒕𝒚𝑪𝒚𝒍𝒄𝒆 =
𝟏/𝟐 ^𝑴𝒂𝒙𝑫𝑪𝒚𝒄𝒍
$$
A value of 0 corresponds to “no duty cycle limitation” except the one set by the regional regulation.

![image-20210903162217082](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/5f33059ccd602fcc0b9e21c268442e35.png)

Format:

```
AT+LW=DC, "ON/OFF"
AT+LW=DC, MaxDCycle
```

Return format:
```+LW=DC, "ON/OFF", MaxDCycle```

1. Check DC option
```AT+LW=DC```
```+LW: DC, ON, 0 // EU868 Duty Cycle ON, MaxDCycle is 0```
2. Set EU868 ETSI Duty Cycle on
```AT+LW=DC, ON```
```+LW: DC, ON, 0 //```
3. Set EU868 ETSI Duty Cycle off
```AT+LW=DC, OFF```
```+LW: DC, OFF```
4. Set LoRaWAN MaxDCycle
```AT+LW=DC```
```+LW: DC, ON, 0 // EU868 Duty Cycle ON, MaxDCycle is 0```
```+LW: DC, OFF, 1 // EU868 Duty Cycle OFF or not in EU868 mode, MaxDCycle is 0```



##### 4.28.4 NET

This command is used to choose public LoRaWAN network or private network. Set ON to choose
public network, set OFF to choose private network.

Format:
```AT+LW=NET, "ON/OFF"```

1. Check network type
```AT+LW=NET```
```+LW: NET, ON```
2. Set public network on
```AT+LW=NET, ON```
```+LW: NET, ON```
3. Set public network off
```AT+LW=NET, OFF```
```+LW: NET, OFF```



##### 4.28.5 MC

MC command could enable an extra broadcast address for LoRaWAN modem. This command is useful
when using Class B or C mode, to control a group of devices which has the same multi cast address at
the same time to use a broadcast downlink command.



Format:
AT+LW=MC,["ON/OFF"],["DEVADDR"],["NWKSKEY"],["APPSKEY"],["COUNTER"]
1. Check multi cast status
AT+LW=MC
+LW: MC, OFF, 00cf3e72, 0
2. Set MC parameters
AT+LW=MC,ON,"11223344","2B7E151628AED2A6ABF7158809CF4F3C","2B7E151628AED2A6ABF7158809CF4F3C",0
+LW: MC, ON, 11223344, 0
Default MC_NWKSKEY and MC_APPSKEY both are 2B7E151628AED2A6ABF7158809CF4F3C.

##### 4.28.6 THLD

Listen before talk threshold control, available value -1 ~ -140 (dBm).
Format:
AT+LW=THLD, thresh_hold

1. Check current threshold level
    AT+LW=THLD
    +LW: THLD, -90
2. Set new threshold
    AT+LW=THLD, -85
    +LW: THLD, -85

##### 4.28.7 BAT

Set DevStatusReq/DevStatusAns battery level value. Available value 0 ~ 255

1. Check current threshold level
    AT+LW=BAT
    +LW: BAT, 255

2. Set new threshold
    AT+LW=BAT, 100

  +LW: BAT, 100

##### 4.28.8 TPS

TPS command can be used to set default TX parameter. UplinkDwellTime and DownlinkDwellTime
option is just for AS923. MaxEIRP is for all bands.
Format:
AT+LW=TPS
AT+LW=TPS, UplinkDwellTime, DownlinkDwellTime, MaxEIRP
UplinkDwellTime: ON/OFF
DownlinkDwellTime: ON/OFF
MaxEIRP: 0~15
Return:
+LW: TPS, UplinkDwellTime, DownlinkDwellTime, MaxEIRP
Example:
AT+LW=TPS, ON, ON, 7
+LW: TPS, ON, ON, 7

##### 4.28.9 SCR

SCR (Sequence counter Checking Relaxed) command could be used to disable strict downlink frame
counter checking. Which is useful for some application, especially in the case which server can’t reset
downlink counter automatically.
Format:
AT+LW=SCR
AT+LW=SCR, ON
AT+LW=SCR, OFF
Return
+LW: SCR, OFF
+LW: SCR, ON
NOTE: If SCR is enabled, there may be security issue, if some recorder downlink and replay back to your device.Be careful to use this
command.
NOTE: If SCR is enabled by default since firmware v2.1.16, disable it if you need more security.

##### 4.28.10 JDC

JDC command could be used to disable the JoinRequest duty cycle limitation.
Format:
AT+LW=JDC
AT+LW=JDC, OFF
AT+LW=JDC, ON
Return:
+LW: JDC, ON
+LW: JDC, OFF



##### 4.28.11 CT

CT command can be used to enable or disable strict lorawan compliance test mode. When disabled AT
modem will optimize several lorawan features to make it more usable for application. By default It is
disabled.
Format:
AT+LW=CT
AT+LW=CT, ON
AT+LW=CT, OFF
Return:
+LW: CT, ON
+LW: CT, OFF

![image-20210903162918892](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/8015a726950166e9164bd006ac95662b.png)

##### 4.28.12 LEN

LEN command can be used to get maximum payload length which is supported to send according to
current data rate.
Format:
AT+LW=LEN
Return:
+LW: LEN, 50
Note: If “AT+LW=LEN” returns 0 length. User must send a dummy AT+MSG command to flush the internal MAC command buffer. And
continue to send more data.

##### 4.28.13 VER

Note: don’t change unless you know what you are doing.
Switch LoRaWAN protocol version.
Format:
AT+LW=VER, Vxx

![image-20210903163002092](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/4fbe97f4e5cca1b9ed831090e4d9ff5c.png)

![image-20210903163014293](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/10b12d908baee7791ab18189b6471c8f.png)

Example:
AT+LW=VER,V102B
+LW: VER, V102B



##### 4.28.14 DTR

Buffer DeviceTimeReq MAC command for AT modem, the MAC command will be sent in next
LoRaWAN transaction controlled by command MSG/CMSG/MSGHEX/CMSGHEX
Format:
AT+LW=DTR
It is recommended to use MSGHEX and CMSGHEX to carry this command if there is no application
payload to send.

##### 4.28.15 LCR

Buffer LinkCheckReq MAC command for AT modem, the MAC command will be sent in next LoRaWAN
transaction controlled by command MSG/CMSG/MSGHEX/CMSGHEX
Format:
AT+LW=LCR
It is recommended to use MSGHEX or CMSGHEX to carry this command if there is no application
payload to send.

##### 4.28.16 LDRO

This command could be used to configure Low Data Rate Optimize option. Which supports 3 status,
AUTO, ON and OFF. Default mode is AUTO. (Note: this conjuration is not memorable, it is set to AUTO
mode when power on or reset)
Format:
AT+LW=LDRO
AT+LW=LDRO,AUTO
AT+LW=LDRO,ON
AT+LW=LDRO,OFF
Example:
AT+LW=LDRO
+LW: LDRO, AUTO

AUTO mode: (LoRaWAN configuration)

![image-20210903163315311](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/554fae1c9fe2ff7f34cfe1d20e5bf52c.png)

Use in LoRaWAN mode:
1. Run AT+LW=LDRO command
2. It will effect in next transaction (Class A uplink and RX windows, or Class B beacon and ping
    windows)
    Use in TEST mode:
3. Run AT+LW=LDRO command
4. Run “AT+LW=RFCFG,freq,sf” command to effect it.
    Example:
5. AT+MODE=TEST
6. AT+LW=LDRO,ON
7. AT+TEST=RFCFG,freq,sf,bw,….
8. AT+TEST=TXLRPKT to send packet or AT+TEST=RXLRPKT to receive
    Note: If LDRO option is not matched between TX and RX, then on receiver side it probably can’t receive packet or receive damaged packet

##### 4.28.17 DCMRX

DCMRX could be used to disable Confirmed Message RX window to speed up uplink period for
Gateway or Server test purpose
Format:
AT+LW=DCMRX
AT+LW=DCMRX,ON
AT+LW=DCMRX,OFF
Example:
AT+LW=DCMRX
+LW: DCMRX, ON

##### 4.28.18 DUMRX

DUMRX could be used to disable Unconfirmed Message RX window to speed up uplink period for
through output uplinks to server in short time to optimize application power consumption and efficiency.
Format:
AT+LW=DUMRX
AT+LW=DUMRX,ON
AT+LW=DUMRX,OFF
Example:
AT+LW=DUMRX
+LW: DUMRX, ON



##### 4.28.19 AFPACK

AFPACK could be enabled to make the AT modem Auto ACK FPending bit to ease the end-device
design. When enabled device will wait to timeout if FPending bit is set
Format:
AT+LW=AFPACK
AT+LW=AFPACK,0 // disable AFPACK function
AT+LW=AFPACK,1~172800 // enable AFPACK, and set timeout to N seconds
Example:
AT+LW=AFPACK
+LW: AFPACK, 0~172800
4.28.20 CHRB
CHRB can be set to enable or disable channel configuration roll back features. Channel roll back
feature in standard LoRaWAN protocol could complex the server and end-device design and could lead
to channel configuration non-synced issue. It is recommended to set CHRB OFF to disable channel roll
back feature (Default setting).
Format:
AT+LW=CHRB
AT+LW=CHRB,OFF // disable AFPACK function
AT+LW=CHRB,ON // enable AFPACK, and set timeout to N seconds
Example:
AT+LW=CHRB
+LW: CHRB, OFF

### 4.29 WDT

WDT command can be used to turn on/off internal watchdog. The watchdog is on by default, this will
enhance the module stability, especially under the condition of severe electromagnetic environment.
After WDT is turned on, the sleep current will be increased by around 0.7uA.
Format:
AT+WDT
AT+WDT=ON
AT+WDT=OFF
Return:
+WDT: ON
+WDT: OFF

### 4.30 LOWPOWER20

Sleep command could be used to make modem enter sleep mode with ultra-low power consumption,
check device datasheet to know detailed parameters. After device enters in sleep mode, host device
could send any character to wakeup it, after this host should wait at least 5ms to send next commands,
so that modem could get ready. A C code example is attached to show how to handle LOWPOWER
mode. 

During the LOWPOWER mode, level of UART RX pin must keep unchanged, any signal on UART RX pin will make modem exit LOWPOWER mode. When LOWPOWER mode is triggered, there are extra 30ms before modem really enter sleep mode, host device should use this time to de-initial its UART if it is needed. It also supplies feature to set a lowpower alarm from 100ms to 129600000ms (36hrs).

[^]: RHF76-052AM (UART enabled) supports this feature, RHF3M076B (USB enabled) doesn't support sleep mode.

Format:
eg: AT+LOWPOWER // Sleep until woke up by UART TX
eg: AT+LOWPOWER=100021 // Sleep 1000ms until timeout
eg: AT+LOWPOWER=AUTOON // Enter extremely low power mode
eg: AT+LOWPOWER=AUTOOFF22 // Exit extremely low power mode
 // Query symbol is not available
Return
+LOWPOWER: SLEEP // Enter SLEEP mode successfully
+LOWPOWER: WAKEUP // Modem is woke up.
Example:
AT+LOWPOWER=1000
+LOWPOWER: WAKEUP
Note: Extra 0x55 will be sent to host mcu to perform a wakeup signal for it, LoRaWAN AT Modem will
wait for 15ms before sending “+LOWPOWER: WAKEUP” frame , host MCU could use this 15ms to
initialize then to receive the WAKEUP frame.
C example:
 printf("AT+LOWPOWER\r\n");// Set low-power mode
// ...
// HOST do other operation.
// ...
 printf("A"); // Send any character to wake-up the modem
 DelayMs(5); // Wait modem ready
printf("AT+ID\r\n"); // New operation
4.30.1 Low Power Auto Mode
AT+LOWPOWER=AUTOON command could be used to enable extremely low power mode. In this
mode modem will enter deep sleep mode when it is idle. The idle status means no ongoing receiving
commands, no ongoing LoRaWAN service needed. If this mode is enabled, when sending commands
to modem, at least four 0xFFs need to be added to the start of each AT command. At the same time,
each return message is also added with four 0xFFs. The host mcu parser should be able to handle
these wakeup characters.
.
Example to send AT+ID command with low power auto mode

| 0xFF | 0xFF | 0xFF | 0xFF | ‘A’  | ‘T’  | ‘+’  | ‘I’  | ‘D’  | ‘\r’ | ‘\n’ |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |

Use AT+LOWPOWER=AUTOOFF command to turn off low power auto mode, four 0xFFs are also needed to add to the start of the command.

[^]: Available after v1.9.5
[^]: It is better to use AT+LOWPOWER=AUTOOFF always with heading 0xFFs

| FF   | FF   | FF   | FF   | A    | T    | +    | L    | O    | W    | P    | O    | W    | E    | R    | =    | A    | U    | T    | O    | O    | F    | F    | \r   | \n   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| FF   | FF   | FF   | FF   | 61   | 74   | 2B   | 6C   | 6F   | 77   | 70   | 6F   | 77   | 65   | 72   | 3D   | 61   | 75   | 74   | 6F   | 6F   | 66   | 66   | 0D   | 0A   |

Below hex string equals to the table above, send it to modem in hex format could also disable the low
power auto on feature.
FFFFFFFF61742B6C6F77706F7765723D6175746F6F66660D0A
C example:
uint8_t buf[256];
printf("AT+LOWPOWER=AUTOON\r\n");// Set low-power auto on mode
// ...
// HOST do other operation.
// ...
buf[0] = 0xFF;
buf[1] = 0xFF;
buf[2] = 0xFF;
buf[3] = 0xFF;
//DelayMs(5); // If user use higher baud rate than 9600, uncomment this line
sprintf(buf+4, "AT+MSG=\"string\"\r\n");
uart_putbuf(buf, strlen(buf+4)+4); // Send command to LoRaWAN modem

### 4.31 VDD23

Get supply voltage, return value in unit 0.01V. Format:
AT+VDD
AT+VDD?
AT+VDD=?
Example:
AT+VDD
+VDD: 3.30V

### 4.32 TEMP

Get temperature, return value in unit °C. Format:
AT+TEMP
AT+TEMP?
AT+TEMP=?
Example:
AT+TEMP
+TEMP: 20.5
Note: Temperature command returns temperature sensed by on chip sensor which gives precision about +/-5°C in worst case, this feature
provides a cheap temperature measurement solution for low precision application

[^]: VDD command is not available on RHF0M062

### 4.33 RTC

Get real time from LoRaWAN modem. When modem is powered on, it always starts from 2000-01-01
00:00:00, user could set new time to modem to sync to the real time.

1. Check current time
    AT+RTC
    +RTC: 2000-01-01 01:00:28 // this means the modem has kept running for 1 hour
2. Set new time to "2016-06-14 18:16:11", this format is very critical, must keep the same format as
    “yyyy-MM-dd HH:mm:ss”, year must starts with 20xx.
    AT+RTC="2016-06-14 18:16:11"
    +RTC: 2016-06-14 18:16:11
3. Get time zone
    AT+RTC=ZONE
    +RTC: ZONE, +00:00
4. Set time zone
    AT+RTC=ZONE, "+08:00"
    +RTC: ZONE, +00:00
5. Get verbose RTC time
    AT+RTC=FULL
    +RTC: YY-MM-DD hh:mm:ss UTCshh:mm, epoch, age
    UTCshh:mm: s -> -/+, hh -> hour, mm -> minute
    epoch: GPS epoch (if LoRaWAN V102 is enabled it is in UTC epoch24)
    age: device start up age in second (AT+RESET / POWER ON / WDT Reset clears age to 0)
6. Check Leap seconds setting
    AT+RTC=LEAPSEC
    +RTC: LEAPSEC, 37
7. Set new leap seconds
    AT+RTC=LEAPSEC,37
    +RTC: LEAPSEC, 37

#### 4.33.1 Time Synchronization

When modem is powered on, it always starts from 2000-01-01 00:00:00, there are 3 ways for user to
sync real time:

- user could set new time to modem to sync to the real time.
- Use AT+LW=DTR command trigger DeviceTimeReq to sync time manually
- LoRaWAN V102B or higher protocol
- In class B mode, time will be synchronized with beacon automatically

#### 4.33.2 Leap second

Check http://www.ietf.org/timezones/data/leap-seconds.list to know the leap second list. As of this
document (year 2017), there has been 37 leap seconds ever. The firmware has preset this value to
calculate the UTC time. In the future, more leap seconds will occur, at that time user should update the
leap second to real one so that AT+RTC command returns right time.

[^]: UTC epoch is already deprecated by LoRa Alliance due to the leap second issue, however AT modem keeps this mode for users whose LoRaWAN server still doesn’t support GPS epoch

#### 4.33.3 Time Zone

AT+RTC=ZONE command can be used to set time zone. Default set to UTC+00:00.

### 4.34 EEPROM

LoRaWAN Modem supports maximum 256 bytes to save user data. Format:
AT+EEPROM=ADDR
AT+EEPROM=ADDR,VAL
Return:
+EEPROM: ADDR, VAL
Both ADDR and VAL are in hex format. Valid range is 0x00 ~ 0xFF. Example:
AT+EEPROM=00, AB
+EEPROM: 00, AB

### 4.35 UART

##### 4.35.1 TIMEOUT

LoRaWAN AT modem supports UART receive timeout feature, AT parser inside the modem start
counts from first "AT" character is received, when counter overflows, a "Input timeout" event will be
triggered. One message like below will be showed. Maximum timeout value is 300ms.
+INFO: Input timeout
AT+UART=TIMEOUT, 0 // Disable timeout feature
AT+UART=TIMEOUT, 1000 // Set timeout 1s feature
AT+UART=TIMEOUT // Get timeout value

##### 4.35.2 BR

BR command could be used to set new baud rate. Available baud rate are 9600 14400 19200 38400
57600 76800 115200 and 230400. New baud rate will be validated after reset or repower.
Format:
AT+UART=BR
AT+UART=BR, br
Return:
+UART=BR, br



### 4.36 TEST

TEST command is not like other command, it is a serious command, includes several sub-commands,
refer to table below. With test mode, user could do RF performance test quickly without any knowledge
of LoRa chip. Commands which are related to RF configuration is disabled in test mode.

![image-20210903164436254](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/c8f8bb7e370c32c73ac052fad0b62b53.png)

#### 4.36.1 Help Information

 STOP -- AT+TEST=STOP
 HELP -- AT+TSET=HELP
 TXCW -- AT+TEST=TXCW
 TXCLORA -- AT+TEST=TXCLORA
 RFCFG -- AT+TEST=RFCFG,[F],[SF],[BW],[TXPR],[RXPR],[POW],[CRC],[IQ],[NET]
 RXLRPKT -- AT+TEST=RXLRPKT
 TXLRPKT -- AT+TEST=TXLRPKT,"HEX"
 TXLRSTR -- AT+TEST=TXLRSTR,"TEXT"
 RSSI -- AT+TEST=RSSI,F,[CNT]
 LWDL -- AT+TEST=LWDL,TYPE,DevAddr,"HEX",[FCNT],[FPORT],[FCTRL]
"[ ]" means the parameter is omissible together with parameters behind it

#### 4.36.2 Enter TEST mode

Before use any TEST command, LoRaWAN should work in test mode, or error code -12 will be
reported.
Command:
AT+MODE=TEST
Return:
+MODE: TEST // LoRaWAN modem enter TEST mode successfully

#### 4.36.3 Query RF configuration

First thing after enter TEST mode should be check RF configuration.
Command:
AT+TEST=? // Query test mode and RF configuration
Return Error:
+TEST: ERROR(-12)

When come with ERROR(-12), user could try "AT+MODE=?" to check if LoRaWAN modem is in TEST mode, if not user should enter test
mode first.
Return STOP:
+TEST: STOP
+TEST: RFCFG F:433300000, SF12, BW125K, TXPR:8, RXPR:8, POW:14dBm, CRC:ON, IQ:OFF,
NET:ON
Return TXLRPKT:
+TEST: TXLRPKT
+TEST: RFCFG F:433300000, SF12, BW125K, TXPR:8, RXPR:8, POW:14dBm, CRC:ON, IQ:OFF,
NET:ON
Return RXLRPKT:
+TEST: RXLRPKT
+TEST: RFCFG F:433300000, SF12, BW125K, TXPR:8, RXPR:8, POW:14dBm, CRC:ON, IQ:OFF,
NET:ON
Return TXCW:
+TEST: TXCW
+TEST: RFCFG F:433300000, SF12, BW125K, TXPR:8, RXPR:8, POW:14dBm, CRC:ON, IQ:OFF,
NET:ON

#### 4.36.4 Set RF Configuration

RFCFG supports set frequency, SF, band width, TX preamble, RX preamble and TX power settings.
TX and RX shares all configuration except "preamble length", user could choose different preamble
length. For LoRa communication, it is strongly recommended to set RX preamble length longer than
TX's. Bandwidth only supports 125KHz / 250KHz / 500KHz.
Depend on Semtech SX1276 (PA_BOOST/RFO) and design solution of RisingHF module, MAX output
power of different band LoRaWAN modem could be different. Check below table about the details.

![image-20210903164557925](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/e75eb3754a1d3112365efe34d5d8c426.png)



Format:
"[ ]" means the parameter is omissible together with parameters after it
AT+TEST=RFCFG,[FREQUENCY],[SF],[BANDWIDTH],[TX PR],[RX PR],[TX POWER],[CRC],[IQ],[NET]
eg: AT+TEST=RFCFG,866,SF12,125,12,15,14,ON,OFF,OFF
FREQUENCY: 866MHz
SpreadFactor: SF12

[^]: LF Band: Frequency is less than 525MHz
[^]: HF Band: Frequency is larger than 525MHz

BandWidth: 125KHz
TX Preamble: 12
RX Preamble: 15
Power: 14dBm
CRC: ON
Inverted IQ: OFF
Public LoRaWAN: OFF
Return:
+TEST: RFCFG F:868100000, SF12, BW125K, TXPR:8, RXPR:8, POW:14dBm, CRC:ON, IQ:OFF, PNET:ON

#### 4.36.5 TX LoRa Packet

After enter test mode, user could send LoRa packet through "AT+TEST=TXLRPKT" sub-command.
The command format is like below:
AT+TEST=TXLRPKT, "HEX STRING"
Command sequence to send LoRa packet:
// Set test mode
AT+MODE=TEST
// Query test mode, check RF configuration
AT+TEST=?
// Set RF Configuration
AT+TEST=RFCFG,[FREQUENCY],[SF],[BANDWIDTH],[TXPR],[RXPR],[POW],[CRC],[IQ],[NET]
// Send HEX format packet
AT+TEST=TXLRPKT, "HEX String"
eg:AT+TEST=TXLRPKT, "00 AA 11 BB 22 CC"
// Send TEXT format packet
AT+TEST=TXLRSTR, "TEXT"
eg:AT+TEST=TXLRSTR, "LoRaWAN Modem"
Return:
+TEST: TXLRPKT “404EA99000800A00089F6E770959”
+TEST: TXLRSTR "LoRaWAN Modem"
+TEST: TX DONE

#### 4.36.6 RX LoRa Packet

After enter test mode, user could enter LoRa packet continuous RX mode through RXLRPKT subcommand. Like below:
AT+TEST=RXLRPKT
Command sequence to receive LoRa packet:
// Set test mode
AT+MODE=TEST
// Query test mode, check RF configuration
AT+TEST=?
// Set RF Configuration
AT+TEST=RFCFG,[FREQUENCY],[SF],[BANDWIDTH], [TXPR],[RXPR],[POW],[CRC],[IQ],[NET]
// Enter RX continuous mode
AT+TEST=RXLRPKT
Return:
+TEST: LEN:250, RSSI:-106, SNR:10
+TEST: RX 404EA99000800A00089F6E770959

#### 4.36.7 TX Continuous Wave

Before enable TXCW function, right frequency and TX power should be set. Format:
AT+TEST=TXCW
Return:
+TEST: TXCW

#### 4.36.8 TX Continuous LoRa

Before enable TXCLORA function, right frequency and TX power should be set. Format:
AT+TEST= TXCLORA
Return:
+TEST: TXCLORA

#### 4.36.9 RSSI

Read RSSI from a specified channel. Format:
AT+TEST = RSSI, frequency(MHz), [times]
Return:
+TEST: RSSI, average, maximum, minimum

#### 4.36.10 LWDL

LWDL command is designed to test LoRaWAN modem CLASS C function. Use this command, user
can easily send data to a working LoRaWAN Class C device.
AT+TEST = LWDL, TYPE, "DevAddr", "HEX STRING", [FCNT], [FPORT], [FCTRL]
FCNT: HEX
FPORT: Decimal
FCTRL: HEX
Return:
AT+TEST=LWDL,MSG,"009291ad","14 54 54 88 08 93 122 35", 1, 5, 00
+TEST: LWDL "A0AD91920000010005134D37EA53E3023A9F0125D234"
+TEST: LWDL TX DONE
Note: Must use AT+TEST=RFCFG command to set CRC OFF, IQ ON, NET ON before sending LoRaWAN downlink.

#### 4.36.11 Beacon Sniffer

AT+TEST=BEACON command can be used to set AT modem into beacon sniffer mode, which could
be useful for server and gateway designer to debug beacon timing.
Format:
AT+TEST=BEACON
+TEST: BEACON
When beacon is received one beacon message is returned to host controller.

+TEST: BEACON, ms, payload, rssi, snr, ticks, vdd, temp
 ms: beacon received time in ms
payload: hex string
 rssi: unit dBm
 snr: unit dB
 ticks: unit 8192Hz
 vdd: unit 0.01V
 temp: unit 0.01°C
Before use Beacon, user also need use AT+TEST=RFCFG command to set CRC OFF, IQ OFF, NET
ON, and use AT+DR=band to select correct band, use AT+LW=VER command to select correct
LoRaWAN protocol.
Command flow to sniff EU868 beacon:
AT+DR=EU868
AT+LW=VER,102B
AT+MODE=TEST
AT+TEST=RFCFG, 869.525, SF9, 125, 8, 8, 20, OFF, OFF, ON
AT+TEST=BEACON
+TEST: BEACON, 232509, 0000804D67475A28000000000000000000, -66, 5, 1905042, 320, 2197
+TEST: BEACON, 232509, 0000804D67475A28000000000000000000, -66, 5, 1905042, 320, 2197
+TEST: BEACON, 360509, 0000004E674732AC000000000000000000, -66, 5, 2953807, 319, 2187
+TEST: BEACON, 488510, 0000804E67470A71000000000000000000, -66, 5, 4002572, 319, 2223
+TEST: BEACON, 616511, 0000004F6747029B000000000000000000, -66, 4, 5051336, 319, 2223
+TEST: BEACON, 744512, 0000804F67473A46000000000000000000, -66, 5, 6100101, 319, 2205
Note: For beacon frequency hopping band like US915/CN470/AU915, BEACON sniffer mode can only sniff a single selected channel.

### 4.37 LOG

LOG command is for user debugging purpose, after log is enabled, AT modem will returns extra log
message to host controller, check these log could help user locate issue quickly when it happens.
Log is turned by default.
Format:
AT+LOG=level // DEBUG/INFO/WARN/ERROR/FATAL/PANIC/QUIET
Enable log:
AT+LOG=DEBUG
Disable log:
AT+LOG=QUIET
Note: if log is enabled it will takes extra energy, for low power application it is recommended to turn off log. 

## 5 Class A/B/C and A/C Different Command

Class A/B/C(v3.1.x) firmware is designed to be backward compatible with Class A/C firmware (v2.1.x),
and add new commands to support LoRaWAN class B.

![image-20210903165905543](https://risinghf-wiki.oss-cn-shenzhen.aliyuncs.com/upload/img/dd073e05e33f84b37a087d4f44a63020.png)

V1.2 2018-12-15
+ Added V1.0.3 support
+ Added AT+LW=DCMRX
+ Added AT+LW=DUMRX
+ Added AT+LW=AFPACK
+ Added AT+LW=CHRB
+ Added AT+JOIN=time (auto sendding JoinRequest)
+ Added new part number:
 RHF76-052CL
  RHF0M003-LF20
  RHF0M003-HF20
  RHF0M010-LF20
  RHF0M010-HF20
  RHF0M062-LF22
  RHF0M062-HF22
+ AT+MSGHEX and AT+CMSGHEX to send empty payload packet
+ Fixed various typos
+ Sync LoRaWAN at modem 3.5.x
V1.1 2018-03-15
+ Added AT+LW=LDRO
+ Sync version 3.2.2
V1.0 2017-12-22
+ Extract AT command from PS01509 v4.4
+ Added AT+LW=VER
+ Added AT+LW=DTR
+ Added AT+LW=LCR
+ Added AT+RTC=ZONE
+ Added AT+RTC=LEAPSEC
+ Added AT+RTC=FULL
+ Added AT+TEMP
+ Added AT+CLASS=B
+ Added AT+BEACON
+ Added AT+TEST=BEACON
+ Added AT+LOG
+ Added Class B band plan description									

